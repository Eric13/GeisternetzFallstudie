<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Geisternetz melden - Registrierung</title>

    <style>
        /* Grundlayout zur Zentrierung des Formulars auf dem Viewport */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* Container fÃ¼r die Eingabemaske nach dem Box-Modell */
        .form-container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,.15);
            width: 600px;
        }

        h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }

        h3 {
            margin-top: 25px;
        }

        /* Fixierung der Spaltenbreite im panelGrid zur Verhinderung von Verschiebungen */
        .input-grid td:first-child {
            width: 200px;
        }

        .input-grid td:last-child {
            width: 350px;
        }

        .input-grid td {
            padding: 5px 0;
        }

        /* Standardisierung der Textfelder fÃ¼r ein einheitliches Design */
        input[type="text"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }

        /* Flexbox-Anordnung der Aktions-Buttons */
        .buttons {
            margin-top: 20px;
            display: flex;
            gap: 15px;
        }

        .save-button {
            background: #28a745;
            color: white;
            padding: 10px 18px;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        .cancel-button {
            background: #6c757d;
            color: white;
            padding: 10px 18px;
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
        }

        .save-button:hover { background:#1e7e34; }
        .cancel-button:hover { background:#545b62; }

    </style>
</h:head>

<h:body>

    <!--NEU: PrÃ¼fen ob Nutzer eingeloggt ist-->
    <f:event type="preRenderView" listener="#{loginBean.checkMelderAccess}" />

    <!-- *** FORMULARCONTAINER *** -->
    <div class="form-container">

        <h2>Neues Geisternetz melden ðŸŒŠ</h2>

        <h:messages style="color:red;"/>

        <h:form id="meldeForm">

            <h3>Daten der meldenden Person</h3>

            <h:panelGrid columns="2" styleClass="input-grid">

                <h:outputLabel value="Name:" />
                <h:panelGroup>
                    <!-- Validierungsreglen hinzugefÃ¼gt-->
                    <h:inputText id="name" value="#{geisternetzBean.melder.name}" required="true" requiredMessage="Der Name ist fÃ¼r die Meldung nÃ¶tig."
                        readonly="#{loginBean.loggedIn}">
                        <f:validateRegex pattern="^[A-Za-zÃ„Ã–ÃœÃ¤Ã¶Ã¼ÃŸ ]+$" disabled="#{loginBean.loggedIn}"/>
                        <f:attribute name="validatorMessage" value="Der Name darf nur Buchstaben und Leerzeichen enthalten." />
                    
                    </h:inputText>
                    <h:message for="name" style="color:red; display:block;"/>
                    
                </h:panelGroup>

                <h:outputLabel value="Telefon (optional):" />
                <h:panelGroup>
                    <h:inputText id="telefon" value="#{geisternetzBean.melder.telefon}" required="false" readonly="#{loginBean.loggedIn}">
                        <!--Validierungsregelen hinzugefÃ¼gt-->
                        <f:convertNumber integerOnly="true"/>
                        <f:attribute name="validatorMessage" value="Die Telefonnummer muss eine Zahl sein." />
                    </h:inputText>
                    <h:message for="telefon" style="color:red; display:block;"/>
                </h:panelGroup>

            </h:panelGrid>

            <h3>Daten des Geisternetzes</h3>

            <h:panelGrid columns="2" styleClass="input-grid">

                <h:outputLabel value="LÃ¤ngengrad:" />
                <h:panelGroup>
                    <!--Validierungsregelen hinzugefÃ¼gt-->
                    <h:inputText id="laenge" value="#{geisternetzBean.netz.laengengrad}" required="true" requiredMessage="LÃ¤ngengrad ist ein Pflichtfeld.">
                        <f:convertNumber type="number" pattern="#0.000000" />
                        <f:validateDoubleRange minimum="-180.0" maximum="180.0" />
                        <f:attribute name="validatorMessage" value="Der Wert muss zwischen -180.0 und 180.0 liegen und eine Zahl sein (mit Punkt als Dezimaltrennzeichen)." />
                    </h:inputText>
                    <h:message for="laenge" style="color:red; display:block;"/>
                </h:panelGroup>

                <h:outputLabel value="Breitengrad:" />
                <h:panelGroup>
                    <!--Validierungsregelen hinzugefÃ¼gt-->
                    <h:inputText id="breite" value="#{geisternetzBean.netz.breitengrad}" required="true" requiredMessage="Breitengrad ist ein Pflichtfeld.">
                        <f:convertNumber type="number" pattern="#0.000000" />
                        <f:validateDoubleRange minimum="-90.0" maximum="90.0" />
                        <f:attribute name="validatorMessage" value="Der Wert muss zwischen -90.0 und 90.0 liegen eine Zahl sein (mit Punkt als Dezimaltrennzeichen)." />
                    </h:inputText>
                    <h:message for="breite" style="color:red; display:block;"/>
                </h:panelGroup>

                <h:outputLabel value="GrÃ¶ÃŸe (mÂ²):" />
                <h:panelGroup>
                    <h:inputText id="groesse" value="#{geisternetzBean.netz.groesse}">
                        <!--Validierungsregelen hinzugefÃ¼gt-->
                        <f:convertNumber integerOnly="true"/>
                        <f:validateLongRange minimum="1" maximum="1000000" />
                        <f:attribute name="validatorMessage" value="Die GrÃ¶ÃŸe muss eine positive Ganzzahl sein." />
                    </h:inputText>
                    <h:message for="groesse" style="color:red; display:block;"/>
                </h:panelGroup>

            </h:panelGrid>

            <!-- Anmerkung: nach dem Speichern erscheint automatisch die Startseite-->
            
            <div class="buttons">
                <h:commandButton value="Speichern"
                                 action="#{geisternetzBean.speichereNetz}"
                                 styleClass="save-button"/>

                <!-- bei Abbrechen RÃ¼ckkehr zur Startseite-->
                <h:link value="Abbrechen"
                        outcome="/index.xhtml"
                        styleClass="cancel-button"/>

</div>
</h:form>

</div>

</h:body>
</html>